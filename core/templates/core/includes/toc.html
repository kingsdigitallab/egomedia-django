{% load kdl_wagtail_core_tags core_tags wagtailcore_tags %}

<nav role="navigation" class="table-of-contents">
    {% if page.body %}
    <h4>Table of Contents</h4>
    <ul>
        {% for block in page.body %}
        <li>
            <a href="#{% get_object_id block %}">
                {% get_block_title block %}
            </a>
        </li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if page.get_children %}
    <h4>Sub projects</h4>
    <ul>
        {% for child in page.get_children %}
        <li><a href="{% pageurl child %}">{{ child.title }}</a></li>
        {% endfor %}
    </ul>
    {% endif %}
</nav>